package org.vulgr.graphql

import org.springframework.stereotype.Component
import org.vulgr.repository.CveRepository


@Component
class QueryImpl(private val cveRepo: CveRepository) : Query {
    override fun affectedProducts(cveId: String, limit: Int): List<Product> =
            cveRepo.getAffectedProducts(cveId, limit).map { (_, product, version, update, cpe)->
                Product(product = product,
                        version = version,
                        update = update,
                        cpe = cpe)
            }
}