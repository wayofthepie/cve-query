package org.vulgr.graphql

import org.springframework.stereotype.Component
import org.vulgr.repository.CveRepository


@Component
class QueryImpl(private val cveRepo: CveRepository) : Query {
    override fun affectedProducts(cveId: String, limit: Int): List<Product> =
            cveRepo.getAffectedProducts(cveId, limit).map { product ->
                Product(product = product.product,
                        version = product.version,
                        update = product.update,
                        cpe = product.cpe)
            }
}