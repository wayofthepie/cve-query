package org.vulgr.repository

import org.springframework.data.neo4j.annotation.Depth
import org.springframework.data.neo4j.annotation.Query
import org.springframework.data.repository.PagingAndSortingRepository
import org.springframework.data.repository.query.Param
import org.springframework.stereotype.Repository

@Repository
interface CveRepository : PagingAndSortingRepository<CVE, Long> {

    @Depth(0)
    @Query("MATCH (c:CVE {cveId: {cveId}})-[r:Affects]-(p:Product) return p limit {limit}")
    fun getAffectedProducts(@Param("cveId") cveId: String, @Param("limit") limit: Int): List<Product>
}